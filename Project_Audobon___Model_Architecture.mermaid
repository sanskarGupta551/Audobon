flowchart TB
    Input[Story Input] --> Story[Story Understanding Model]
    Style[Style Input] --> Visual[Visual Generation Model]
    
    subgraph StoryModel[Story Understanding]
        direction TB
        SEnc[LLAMA2 Encoder] --> SUnd[T5 Understanding]
        SUnd --> SAna[Narrative Analysis]
        SAna --> SOut[Story Structure]
        
        SEnc --> SCtx[Context Tracking]
        SCtx --> SAna
    end
    
    subgraph VisualModel[Visual Generation]
        direction TB
        VCond[Style Conditioning] --> VGen[SD Generation]
        VGen --> VEnh[Quality Enhancement]
        VEnh --> VCtrl[ControlNet]
        
        StyleCtrl[Style Control] --> VCond
        StyleCtrl --> VEnh
    end
    
    subgraph Integration[Cross-Modal Integration]
        direction TB
        Cross[Cross Attention] --> Fusion[Feature Fusion]
        Fusion --> Align[Modal Alignment]
    end
    
    subgraph Quality[Quality Control]
        direction TB
        QCheck[Quality Check] --> Consist[Consistency]
        Consist --> Valid[Validation]
    end
    
    Story --> Integration
    Visual --> Integration
    Integration --> Quality
    Quality --> Output[Final Output]
    
    SOut --> Cross
    VCtrl --> Fusion